---
title: "ClassCandy"
author: "Ksenia Mekhonoshina"
format: pdf
toc: true
---

## Background

In todays mini project, we wil analyze candy data with exploratory graphics, basic statistics, correlation analysis and principal component analysis methods we have been learning.

## Data Import

```{r}
candy_file <- read.csv("Candy Mini-Project Data.txt")
candy <- read.csv("Candy Mini-Project Data.txt", row.names=1)
head(candy)
```

## What is the dataset?

Let's analyze our data.

> Q1. How many different candy types are in this dataset?

```{r}
nrow(candy)
```
There are 85 candy types in this dataset

> Q2. How many fruity candy types are in the dataset?

```{r}
sum(candy$fruity)
```

There are 38 fruity candy types

## Fav candy

We can find out the percentage of people who prefer this candy over another randomly chosen candy by using `winpercent`:

```{r}
candy["Twix", ]$winpercent
```
 
> Q3. What is your favorite candy (other than Twix) in the dataset and what is it’s winpercent value?

Kit Kat, and the winpercent is `r candy["Kit Kat", ]$winpercent`

> Q4. What is the winpercent value for “Kit Kat”?

Opps, it is `r candy["Kit Kat", ]$winpercent`. We got this using `candy["Kit Kat", ]$winpercent` and r in front of the code

> Q5. What is the winpercent value for “Tootsie Roll Snack Bars”?

`r candy["Tootsie Roll Snack Bars", ]$winpercent`. Not that many ppl like it


```{r}
library("skimr")
skim(candy)
```



> Q6. Is there any variable/column that looks to be on a different scale to the majority of the other columns in the dataset?

N_missing and complete_rate are either 0 or 1

> Q7. What do you think a zero and one represent for the candy$chocolate column?

Whether there was any data input in the data set


## Exploratory analysis
> Q8. Plot a histogram of winpercent values using both base R an ggplot2.

Lets do base R first:

```{r}
hist(candy$winpercent, breaks=25)
```
Now, let's do the ggplot:

```{r}
library(ggplot2)
ggplot(candy) +
     aes(winpercent)+
     geom_histogram(bins=12, fill="lightpink", col="red")
```

> Q9. Is the distribution of winpercent values symmetrical?

No, it is not (doesn't look like it)

> Q10. Is the center of the distribution above or below 50%?

It is above, we got it by using `mean`
```{r}
mean(candy$winpercent)
```

Not that good to use with non-normally distributed data

```{r}
summary(candy)
```

> Q11. On average is chocolate candy higher or lower ranked than fruit candy?

First, we gotta find all chocolate candy in the dataset -> extract their winpercent values -> calc the mean -> find alll fruit candy -> find their winpercent -> calc their mean

Steps 1-3:
```{r}
choc.candy <- candy[candy$chocolate==1,]
choc.win <- choc.candy$winpercent
mean(choc.win)
```
Let's do the same for the fruity candy (steps 3-6):

```{r}
fruit.candy <- candy[candy$fruity==1,]
fruit.win <- fruit.candy$winpercent
mean(fruit.win)
```
Sp, the chocolate candy is higher ranked than fruit candy (I agree)

> Q12. Is this difference statistically significant?

```{r}
t.test(choc.win, fruit.win)

```
So, the difference between the values is statisticlly significant


## Overall Candy Rankings

> Q13. What are the five least liked candy types in this set?

```{r}
inds <- order(candy$winpercent)
head(candy[inds, ], 5)
```
Nik L Nip, Boston Baked Beans, Chiclets, Super Bubble, Jawbusters
> Q14. What are the top 5 all time favorite candy types out of this set?

We do the same - but we meed top 5 candies
```{r}
inds_max <- rev(inds)        
head(candy[inds_max, ], 5)
```
We got: reese's peanut butter cup, reese's miniatures, twix, kit kat, snickers

> Q15. Make a first barplot of candy ranking based on winpercent values.


```{r}
ggplot(candy) + 
  aes(winpercent, rownames(candy)) +
  geom_col() + 
  ylab("")

ggsave("barplot1.png",  height=10, width=4)
```
![](barplot1.png)



> Q16. This is quite ugly, use the reorder() function to get the bars sorted by winpercent?

```{r}
ggplot(candy) + 
  aes(winpercent, 
      reorder ( rownames(candy), winpercent)) +
  geom_col() + 
  ylab("")

  
ggsave("barplot2.png",  height=10, width=4)
```
![My second barplot for q16](barplot2.png)


## Time to add some useful color

Color by chart:
```{r}
ggplot(candy) + 
  aes(winpercent, 
      reorder ( rownames(candy), winpercent),
      fill=chocolate) +
  geom_col() + 
  ylab("")
```
I want custom colors so lets do it ourselves
```{r}
my_cols <- rep("black", nrow(candy))
my_cols[candy$chocolate==1] <- "lightpink"
my_cols[candy$bar==1] <- "lightgreen"
my_cols[candy$fruity==1] <- "red"
my_cols
```

```{r}
ggplot(candy) + 
  aes(winpercent, 
      reorder ( rownames(candy), winpercent))+
  geom_col(fill= my_cols) + 
  ylab("")
```
> Q17. What is the worst ranked chocolate candy?

Nik L Lip
> Q18. What is the best ranked fruity candy

Starburst

## Taking a look at pricepercent

```{r}
my_cols[candy$fruity==1]

ggplot(candy) +
  aes(x=winpercent, y=pricepercent, label=rownames(candy)) +
  geom_point(col=my_cols) + 
  geom_text(col=my_cols, size=3.3, max.overlaps = 5)
```

We can use the **ggrepel** package for better label placement:

```{r}
library(ggrepel)

ggplot(candy) +
  aes(x=winpercent, y=pricepercent, label=rownames(candy)) +
  geom_point(col=my_cols) + 
  geom_text_repel(col=my_cols, size=3.3, max.overlaps = 7, size=3.3)
```

## Exploring the correlation structure

Pearson correlation values range from -1 to +1

```{r}
library(corrplot)

cij <- cor(candy)
corrplot(cij)
```

## PCA

```{r}
pca<-prcomp(candy, scale=T)
summary(pca)
```

The main results figure: PCA score plot

```{r}
ggplot(pca$x)+
  aes(PC1, PC2, label=rownames(pca$x))+
  geom_point(col=my_cols)+
  geom_text_repel(col=my_cols)+
  labs(title="PCA Candy Space Map",
       subtitle = "Seperation of chocolates")
```
> Q24. Complete the code to generate the loadings plot above. What original variables are picked up strongly by PC1 in the positive direction? Do these make sense to you? Where did you see this relationship highlighted previously?

The "loadings" plot for PC1

```{r}
ggplot(pca$rotation)+
  aes(PC1, 
      reorder(rownames(pca$rotation), PC1))+
  geom_col()
```
```{r}

```

> Q25. Based on your exploratory analysis, correlation findings, and PCA results, what combination of characteristics appears to make a “winning” candy? How do these different analyses (visualization, correlation, PCA) support or complement each other in reaching this conclusion?

We would want to have chocolate, fruity candies. But not chocolate-fruity camdies. Also chocolate bars would be cool. 